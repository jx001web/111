(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{112:function(e,t,a){},124:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(12),i=a.n(r),o=(a(112),a(13)),s=a(15),l=a(92),d=a(187),m=a(188),j=a(1);const p=Object(n.createContext)(null),h=e=>{let{children:t}=e;const[a,c]=Object(n.useState)(null),[r,i]=Object(n.useState)(!0),[o,s]=Object(n.useState)("");Object(n.useEffect)((()=>{const e=localStorage.getItem("user"),t=localStorage.getItem("token");e&&t&&c(JSON.parse(e)),i(!1)}),[]);return Object(j.jsx)(p.Provider,{value:{user:a,login:(e,t)=>{c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("token",t),s("\u767b\u5f55\u6210\u529f\uff01")},logout:()=>{c(null),localStorage.removeItem("user"),localStorage.removeItem("token"),s("\u5df2\u7ecf\u5b89\u5168\u9000\u51fa\uff01")},loading:r,message:o,setMessage:s,updateUser:e=>{c(e),localStorage.setItem("user",JSON.stringify(e))}},children:!r&&t})},g=()=>Object(n.useContext)(p);var b=a(158),u=a(160),x=a(57),f=a(189),O=a(162),v=a(163),y=a(96),w=a(194),S=a(164),C=a(190),N=a(165),k=a(166),I=a(167),B=a(168),T=a(195),z=a(169),W=a(170),E=a(171),A=a(86),D=a.n(A),L=a(48),P=a.n(L),R=a(70),_=a.n(R),F=a(69),M=a.n(F),H=a(49),q=a.n(H);const J=Object(b.a)((e=>({root:{backgroundColor:"#ffffff",minHeight:"100vh",paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},container:{maxWidth:1200},profileSection:{backgroundColor:"#ffffff",borderRadius:16,padding:e.spacing(4),boxShadow:"none",borderBottom:"1px solid #f0f0f0"},avatar:{width:100,height:100,margin:"0 auto",marginBottom:e.spacing(2),backgroundColor:e.palette.primary.main,fontSize:"2rem"},username:{fontWeight:600,fontSize:"1.5rem",color:"#1a1a1a",marginBottom:e.spacing(.5)},email:{color:"#666",marginBottom:e.spacing(3)},balanceSection:{backgroundColor:e.palette.primary.main,color:"white",padding:e.spacing(3),borderRadius:12,marginBottom:e.spacing(3)},balanceIcon:{fontSize:32,marginRight:e.spacing(1)},balanceAmount:{fontSize:"2rem",fontWeight:600,marginTop:e.spacing(1)},newItemButton:{backgroundColor:e.palette.primary.main,color:"white",padding:e.spacing(1.5,3),borderRadius:25,fontSize:"0.9rem",fontWeight:600,textTransform:"none","&:hover":{backgroundColor:e.palette.primary.dark}},contentSection:{backgroundColor:"#ffffff",borderRadius:16,boxShadow:"none",borderBottom:"1px solid #f0f0f0",overflow:"hidden"},tabs:{"& .MuiTab-root":{color:"#666",margin:e.spacing(0,2),fontWeight:500,fontSize:"0.95rem",textTransform:"none","&:hover":{color:e.palette.primary.main,backgroundColor:"transparent"}}},itemCard:{height:"100%",borderRadius:12,overflow:"hidden",backgroundColor:"#ffffff",boxShadow:"none",borderBottom:"1px solid #f0f0f0",transition:"transform 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)"}},itemImage:{height:200,backgroundSize:"cover",backgroundPosition:"center"},itemContent:{padding:e.spacing(2)},itemTitle:{fontSize:"1.1rem",fontWeight:600,marginBottom:e.spacing(1),color:"#1a1a1a"},itemDescription:{color:"#666",fontSize:"0.9rem",marginBottom:e.spacing(2)},price:{color:e.palette.primary.main,fontSize:"1.25rem",fontWeight:600,marginBottom:e.spacing(1)},dateText:{color:"#666",fontSize:"0.85rem"},itemActions:{padding:e.spacing(1),display:"flex",justifyContent:"flex-end",gap:e.spacing(1),borderTop:"1px solid #f0f0f0"},actionButton:{padding:8,color:"#666","&:hover":{backgroundColor:"rgba(0,0,0,0.03)"}},deleteButton:{padding:8,color:e.palette.error.main,"&:hover":{backgroundColor:"rgba(0,0,0,0.03)"}},dialog:{"& .MuiDialog-paper":{borderRadius:12}},dialogTitle:{backgroundColor:e.palette.primary.main,color:"white"},dialogContent:{padding:e.spacing(3)},dialogActions:{padding:e.spacing(2)},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300},noItems:{textAlign:"center",padding:e.spacing(6),color:"#666"},favoriteCard:{height:"100%",borderRadius:12,overflow:"hidden",backgroundColor:"#ffffff",boxShadow:"none",borderBottom:"1px solid #f0f0f0",transition:"transform 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)"}},favoriteButton:{color:e.palette.error.main,"&:hover":{backgroundColor:"rgba(0,0,0,0.03)"}},balanceCard:{backgroundColor:e.palette.primary.main,color:"white",padding:e.spacing(2),borderRadius:e.shape.borderRadius,marginTop:e.spacing(2),textAlign:"center",cursor:"pointer","&:hover":{backgroundColor:e.palette.primary.dark}},container:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},email:{marginTop:e.spacing(1),color:e.palette.text.secondary}})));var U=function(){const e=J(),{user:t}=g(),a=Object(s.f)(),[c,r]=Object(n.useState)([]),[i,o]=Object(n.useState)(!0),[l,d]=Object(n.useState)(0),[m,p]=Object(n.useState)(!1),[h,b]=Object(n.useState)(null),[A,L]=Object(n.useState)([]),[R,F]=Object(n.useState)(!0),[H,U]=Object(n.useState)(0);Object(n.useEffect)((()=>{t&&G()}),[t]),Object(n.useEffect)((()=>{Y()}),[]);const G=async()=>{try{const e=await fetch("http://localhost:5000/api/items/user/".concat(t.id)),a=await e.json();r(a)}catch(e){console.error("Error fetching user items:",e)}finally{o(!1)}};if(Object(n.useEffect)((()=>{t&&(async()=>{try{const e=localStorage.getItem("token"),t=await fetch("http://localhost:5000/api/favorites",{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();L(a)}catch(e){console.error("Error fetching favorites:",e)}finally{F(!1)}})()}),[t]),!t)return Object(j.jsx)(u.a,{className:e.root,children:Object(j.jsx)(x.a,{variant:"h5",align:"center",children:"\u8bf7\u5148\u767b\u5f55\u4ee5\u67e5\u770b\u4e2a\u4eba\u8d44\u6599"})});const Y=async()=>{try{const e=await fetch("http://localhost:5000/api/users/balance",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();e.ok&&U(t.balance)}catch(e){console.error("Error fetching balance:",e)}};return Object(j.jsx)(f.a,{className:e.root,children:Object(j.jsxs)(u.a,{className:e.container,children:[Object(j.jsxs)(O.a,{container:!0,spacing:4,children:[Object(j.jsx)(O.a,{item:!0,xs:12,md:4,children:Object(j.jsx)(v.a,{in:!0,timeout:800,children:Object(j.jsx)(y.a,{className:e.profileSection,elevation:0,children:Object(j.jsxs)(f.a,{textAlign:"center",children:[Object(j.jsx)(w.a,{className:e.avatar,children:t.username.charAt(0).toUpperCase()}),Object(j.jsx)(x.a,{className:e.username,children:t.username}),Object(j.jsx)(x.a,{className:e.email,children:t.email}),Object(j.jsxs)(f.a,{className:e.balanceSection,children:[Object(j.jsxs)(f.a,{display:"flex",alignItems:"center",justifyContent:"center",children:[Object(j.jsx)(D.a,{className:e.balanceIcon}),Object(j.jsx)(x.a,{variant:"h6",children:"\u6211\u7684\u4f59\u989d"})]}),Object(j.jsxs)(x.a,{className:e.balanceAmount,children:["\xa5 ",null===H||void 0===H?void 0:H.toFixed(2)]})]}),Object(j.jsx)(S.a,{variant:"contained",className:e.newItemButton,onClick:()=>{a.push("/items/new")},startIcon:Object(j.jsx)(M.a,{}),children:"\u53d1\u5e03\u65b0\u5546\u54c1"})]})})})}),Object(j.jsx)(O.a,{item:!0,xs:12,md:8,children:Object(j.jsx)(v.a,{in:!0,timeout:1e3,children:Object(j.jsxs)(y.a,{className:e.contentSection,elevation:0,children:[Object(j.jsxs)(C.a,{value:l,onChange:(e,t)=>{d(t)},indicatorColor:"primary",textColor:"primary",centered:!0,className:e.tabs,children:[Object(j.jsx)(N.a,{label:"\u6211\u53d1\u5e03\u7684\u5546\u54c1"}),Object(j.jsx)(N.a,{label:"\u6211\u7684\u6536\u85cf"})]}),Object(j.jsx)(k.a,{}),0===l&&Object(j.jsx)(f.a,{p:3,children:i?Object(j.jsx)(f.a,{className:e.loadingContainer,children:Object(j.jsx)(I.a,{style:{color:"#8E37D7"}})}):0===c.length?Object(j.jsx)(x.a,{className:e.noItems,children:"\u8fd8\u6ca1\u6709\u53d1\u5e03\u4efb\u4f55\u5546\u54c1"}):Object(j.jsx)(O.a,{container:!0,spacing:3,children:c.map((t=>Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(j.jsxs)(y.a,{className:e.itemCard,elevation:0,children:[Object(j.jsx)("div",{className:e.itemImage,style:{backgroundImage:"url(http://localhost:5000".concat(t.image,")")}}),Object(j.jsxs)("div",{className:e.itemContent,children:[Object(j.jsx)(x.a,{className:e.itemTitle,children:t.title}),Object(j.jsx)(x.a,{className:e.itemDescription,children:t.description}),Object(j.jsxs)(x.a,{className:e.price,children:["\xa5 ",t.price]}),Object(j.jsxs)(x.a,{className:e.dateText,children:["\u53d1\u5e03\u4e8e ",new Date(t.createdAt).toLocaleDateString()]})]}),Object(j.jsxs)("div",{className:e.itemActions,children:[Object(j.jsx)(B.a,{className:e.actionButton,onClick:()=>a.push("/items/".concat(t._id,"/edit")),size:"small",children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(B.a,{className:e.deleteButton,onClick:()=>(e=>{b(e),p(!0)})(t),size:"small",children:Object(j.jsx)(P.a,{})})]})]})},t._id)))})}),1===l&&Object(j.jsx)(f.a,{p:3,children:R?Object(j.jsx)(f.a,{className:e.loadingContainer,children:Object(j.jsx)(I.a,{style:{color:"#1976d2"}})}):0===A.length?Object(j.jsx)(x.a,{className:e.noItems,children:"\u8fd8\u6ca1\u6709\u6536\u85cf\u4efb\u4f55\u5546\u54c1"}):Object(j.jsx)(O.a,{container:!0,spacing:3,children:A.map((t=>Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(j.jsxs)(y.a,{className:e.favoriteCard,elevation:0,children:[Object(j.jsx)("div",{className:e.itemImage,style:{backgroundImage:"url(http://localhost:5000".concat(t.image,")")}}),Object(j.jsxs)("div",{className:e.itemContent,children:[Object(j.jsx)(x.a,{className:e.itemTitle,children:t.title}),Object(j.jsx)(x.a,{className:e.itemDescription,children:t.description}),Object(j.jsxs)(x.a,{className:e.price,children:["\xa5 ",t.price]}),Object(j.jsxs)(x.a,{className:e.dateText,children:["\u6536\u85cf\u4e8e ",new Date(t.createdAt).toLocaleDateString()]})]}),Object(j.jsx)("div",{className:e.itemActions,children:Object(j.jsx)(B.a,{className:e.favoriteButton,onClick:()=>(async e=>{try{const t=localStorage.getItem("token");(await fetch("http://localhost:5000/api/favorites/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok&&L(A.filter((t=>t._id!==e)))}catch(t){console.error("Error removing favorite:",t)}})(t._id),size:"small",children:Object(j.jsx)(q.a,{})})})]})},t._id)))})})]})})})]}),Object(j.jsxs)(T.a,{open:m,onClose:()=>p(!1),className:e.dialog,children:[Object(j.jsx)(z.a,{className:e.dialogTitle,children:"\u786e\u8ba4\u5220\u9664"}),Object(j.jsx)(W.a,{className:e.dialogContent,children:Object(j.jsxs)(x.a,{children:['\u786e\u5b9a\u8981\u5220\u9664\u5546\u54c1 "',null===h||void 0===h?void 0:h.title,'" \u5417\uff1f\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\u3002']})}),Object(j.jsxs)(E.a,{className:e.dialogActions,children:[Object(j.jsx)(S.a,{onClick:()=>p(!1),variant:"outlined",style:{borderRadius:20},children:"\u53d6\u6d88"}),Object(j.jsx)(S.a,{onClick:async()=>{try{const e=localStorage.getItem("token");(await fetch("http://localhost:5000/api/items/".concat(h._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok&&(r(c.filter((e=>e._id!==h._id))),G())}catch(e){console.error("Delete error:",e)}finally{p(!1),b(null)}},variant:"contained",color:"secondary",style:{borderRadius:20},children:"\u786e\u8ba4\u5220\u9664"})]})]})]})})},G=a(172),Y=a(173),K=a(174),Q=a(93),V=a(177),X=a(54),Z=a.n(X),$=a(87),ee=a.n($);const te=Object(b.a)((e=>({root:{flexGrow:1},appBar:{backgroundColor:"#ffffff",boxShadow:"none",borderBottom:"1px solid #f0f0f0"},toolbar:{minHeight:70,padding:e.spacing(0,3),display:"flex",alignItems:"center"},logo:{flexGrow:1,textDecoration:"none",display:"flex",alignItems:"center","& img":{height:35,marginRight:e.spacing(1)}},logoText:{color:"#1a1a1a",fontWeight:700,fontSize:"1.5rem",letterSpacing:"-0.5px","&:hover":{textDecoration:"none"}},navLinks:{display:"flex",alignItems:"center",marginRight:e.spacing(3)},navLink:{color:"#666",margin:e.spacing(0,2),fontWeight:500,fontSize:"0.95rem","&:hover":{color:e.palette.primary.main,backgroundColor:"transparent"}},publishButton:{backgroundColor:e.palette.primary.main,color:"white",padding:"8px 24px",borderRadius:25,fontSize:"0.9rem",fontWeight:600,textTransform:"none","&:hover":{backgroundColor:e.palette.primary.dark}},iconSection:{display:"flex",alignItems:"center",marginLeft:e.spacing(2)},iconButton:{color:"#666",padding:8,marginLeft:e.spacing(1),"&:hover":{backgroundColor:"rgba(0,0,0,0.03)"}},badge:{backgroundColor:e.palette.primary.main},avatar:{width:35,height:35,marginLeft:e.spacing(2),cursor:"pointer",border:"2px solid #fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},menuItem:{padding:"10px 24px",fontSize:"0.95rem",minWidth:180,"&:hover":{backgroundColor:"rgba(0,0,0,0.03)"}},menuDivider:{margin:"8px 0",backgroundColor:"#f0f0f0"}})));var ae=function(){var e;const t=te(),{user:a,logout:r}=g(),[i,l]=Object(n.useState)(0),d=Object(s.f)(),[m,p]=c.a.useState(null),h=()=>{p(null)},b=async()=>{if(a)try{const e=await fetch("http://localhost:5000/api/messages/unread/count",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();l(t.count)}catch(e){console.error("Error fetching unread count:",e)}};return Object(n.useEffect)((()=>{b();const e=setInterval(b,500);return()=>clearInterval(e)}),[a]),console.log("Current user:",a),Object(j.jsx)(G.a,{position:"sticky",className:t.appBar,elevation:0,children:Object(j.jsx)(u.a,{maxWidth:"lg",children:Object(j.jsxs)(Y.a,{className:t.toolbar,children:[Object(j.jsxs)(o.b,{to:"/",className:t.logo,children:[Object(j.jsx)("img",{src:"".concat(".","/logo.png"),alt:"Logo"}),Object(j.jsx)(x.a,{className:t.logoText,children:"\u4e8c\u624b\u96c6\u5e02"})]}),a?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(f.a,{className:t.navLinks,children:Object(j.jsx)(S.a,{className:t.navLink,component:o.b,to:"/discover",children:"\u53d1\u73b0"})}),Object(j.jsx)(S.a,{variant:"contained",className:t.publishButton,startIcon:Object(j.jsx)(M.a,{}),component:o.b,to:"/items/new",children:"\u53d1\u5e03\u5546\u54c1"}),Object(j.jsxs)(f.a,{className:t.iconSection,children:[Object(j.jsx)(B.a,{color:"inherit",component:o.b,to:"/favorites",children:Object(j.jsx)(q.a,{style:{color:"#f44336"}})}),Object(j.jsxs)(B.a,{color:"inherit",component:o.b,to:"/cart",children:[Object(j.jsx)(Z.a,{}),"  "]}),Object(j.jsx)(B.a,{color:"inherit",component:o.b,to:"/messages",children:Object(j.jsx)(K.a,{badgeContent:i>0?i:null,color:"secondary",children:Object(j.jsx)(ee.a,{})})}),Object(j.jsx)(w.a,{className:t.avatar,onClick:e=>{p(e.currentTarget)},src:a.avatar,children:null===(e=a.username)||void 0===e?void 0:e.charAt(0)}),Object(j.jsxs)(Q.a,{anchorEl:m,open:Boolean(m),onClose:h,TransitionComponent:v.a,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{elevation:2,style:{borderRadius:12,marginTop:8}},children:[Object(j.jsx)(V.a,{className:t.menuItem,children:Object(j.jsxs)(f.a,{display:"flex",flexDirection:"column",children:[Object(j.jsx)(x.a,{variant:"subtitle2",children:a.username}),Object(j.jsx)(x.a,{variant:"caption",color:"textSecondary",children:a.email})]})}),Object(j.jsx)("div",{className:t.menuDivider}),Object(j.jsx)(V.a,{className:t.menuItem,onClick:()=>{h(),d.push("/profile")},children:"\u4e2a\u4eba\u4e3b\u9875"}),Object(j.jsx)(V.a,{className:t.menuItem,onClick:()=>{h(),d.push("/my-items")},children:"\u6211\u7684\u8ba2\u5355"}),Object(j.jsx)(V.a,{className:t.menuItem,onClick:()=>{h(),d.push("/account/settings")},children:"\u8d26\u53f7\u8bbe\u7f6e"}),Object(j.jsx)("div",{className:t.menuDivider}),Object(j.jsx)(V.a,{className:t.menuItem,onClick:()=>{h(),r(),d.push("/login")},children:"\u9000\u51fa\u767b\u5f55"})]})]})]}):Object(j.jsxs)(f.a,{children:[Object(j.jsx)(S.a,{color:"primary",className:t.navLink,component:o.b,to:"/login",children:"\u767b\u5f55"}),Object(j.jsx)(S.a,{variant:"contained",color:"primary",className:t.publishButton,component:o.b,to:"/register",children:"\u6ce8\u518c"})]})]})})})},ne=a(98),ce=a(196),re=a(178),ie=a(192),oe=a(181),se=a(182),le=a(183),de=a(184),me=a(88),je=a.n(me),pe=a(89),he=a.n(pe);const ge=Object(b.a)((e=>({root:{backgroundColor:"#f5f7fa",minHeight:"100vh",paddingBottom:e.spacing(4)},banner:{width:"100%",height:400,position:"relative",backgroundColor:"#ffffff",overflow:"hidden",display:"flex",backgroundImage:"url(".concat(".","/11.png)"),alignItems:"center",justifyContent:"center",marginBottom:e.spacing(4)},bannerContent:{textAlign:"center",zIndex:1,marginTop:-120},searchContainer:{padding:e.spacing(2),marginBottom:e.spacing(3),backgroundColor:"#ffffff",borderRadius:e.shape.borderRadius,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},search:{display:"flex",alignItems:"center",backgroundColor:"#f5f5f5",borderRadius:e.shape.borderRadius,padding:e.spacing(1,2)},searchInput:{flex:1,marginLeft:e.spacing(1),fontSize:"1rem"},filterSection:{padding:e.spacing(2,0),display:"flex",alignItems:"center",flexWrap:"wrap",gap:e.spacing(1)},filterChip:{margin:e.spacing(.5)},itemCard:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"}},itemMedia:{height:200,position:"relative"},itemContent:{flexGrow:1,padding:e.spacing(2)},cardActions:{padding:e.spacing(2),borderTop:"1px solid #f0f0f0",justifyContent:"space-between"},price:{color:e.palette.primary.main,fontWeight:600,fontSize:"1.25rem",marginTop:e.spacing(1)},buyButton:{borderRadius:20,textTransform:"none",fontWeight:500,padding:e.spacing(1,3)},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:400},sortSelect:{marginLeft:"auto",minWidth:150},categoryTitle:{marginBottom:e.spacing(2),fontWeight:600},noItems:{textAlign:"center",padding:e.spacing(4)}}))),be=["\u5168\u90e8","\u7535\u5b50\u4ea7\u54c1","\u670d\u88c5","\u56fe\u4e66","\u5bb6\u5c45","\u8fd0\u52a8","\u5176\u4ed6"];var ue=function(){const e=ge(),t=Object(s.f)(),{user:a}=g(),[c,r]=Object(n.useState)([]),[i,o]=Object(n.useState)(!0),[l,d]=Object(n.useState)(""),[m,p]=Object(n.useState)("\u5168\u90e8"),[h,b]=Object(n.useState)("newest"),[v,w]=Object(n.useState)("");Object(n.useEffect)((()=>{C()}),[m,h]);const C=async()=>{try{o(!0);const e=await fetch("http://localhost:5000/api/items");if(!e.ok)throw new Error("\u83b7\u53d6\u5546\u54c1\u5217\u8868\u5931\u8d25");const t=await e.json();let a="\u5168\u90e8"===m?t:t.filter((e=>e.category===m));l&&(a=a.filter((e=>e.title.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase())))),a.sort(((e,t)=>{switch(h){case"priceAsc":return e.price-t.price;case"priceDesc":return t.price-e.price;default:return new Date(t.createdAt)-new Date(e.createdAt)}})),r(a),w("")}catch(e){console.error("Error fetching items:",e),w("\u83b7\u53d6\u5546\u54c1\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}finally{o(!1)}};return v?Object(j.jsx)(u.a,{children:Object(j.jsx)(x.a,{color:"error",align:"center",children:v})}):Object(j.jsxs)("div",{className:e.root,children:[Object(j.jsx)("div",{className:e.banner,children:Object(j.jsxs)("div",{className:e.bannerContent,children:[Object(j.jsx)(x.a,{variant:"h3",gutterBottom:!0,children:"\u53d1\u73b0\u597d\u7269"}),Object(j.jsx)(x.a,{variant:"h6",color:"textSecondary",children:"\u4e8c\u624b\u4ea4\u6613\uff0c\u8ba9\u95f2\u7f6e\u7115\u53d1\u65b0\u751f"})]})}),Object(j.jsxs)(u.a,{children:[Object(j.jsxs)(y.a,{className:e.searchContainer,children:[Object(j.jsx)("form",{onSubmit:e=>{e.preventDefault(),C()},children:Object(j.jsxs)("div",{className:e.search,children:[Object(j.jsx)(je.a,{color:"action"}),Object(j.jsx)(ne.a,{className:e.searchInput,placeholder:"\u641c\u7d22\u5546\u54c1...",value:l,onChange:e=>d(e.target.value)}),Object(j.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",className:e.buyButton,children:"\u641c\u7d22"})]})}),Object(j.jsxs)("div",{className:e.filterSection,children:[Object(j.jsx)(f.a,{display:"flex",alignItems:"center",flexWrap:"wrap",flex:1,children:be.map((t=>Object(j.jsx)(ce.a,{label:t,onClick:()=>p(t),className:e.filterChip,color:m===t?"primary":"default",variant:m===t?"default":"outlined"},t)))}),Object(j.jsx)(re.a,{variant:"outlined",size:"small",className:e.sortSelect,children:Object(j.jsxs)(ie.a,{value:h,onChange:e=>b(e.target.value),startAdornment:Object(j.jsx)(he.a,{style:{marginRight:8}}),children:[Object(j.jsx)(V.a,{value:"newest",children:"\u6700\u65b0\u53d1\u5e03"}),Object(j.jsx)(V.a,{value:"priceAsc",children:"\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8"}),Object(j.jsx)(V.a,{value:"priceDesc",children:"\u4ef7\u683c\u4ece\u9ad8\u5230\u4f4e"})]})})]})]}),i?Object(j.jsx)("div",{className:e.loadingContainer,children:Object(j.jsx)(I.a,{})}):0===c.length?Object(j.jsx)(y.a,{className:e.noItems,children:Object(j.jsx)(x.a,{variant:"h6",color:"textSecondary",children:"\u6682\u65e0\u5546\u54c1"})}):Object(j.jsx)(O.a,{container:!0,spacing:3,children:c.map((a=>Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(j.jsxs)(oe.a,{className:e.itemCard,children:[Object(j.jsx)(se.a,{className:e.itemMedia,image:"http://localhost:5000".concat(a.image),title:a.title}),Object(j.jsxs)(le.a,{className:e.itemContent,children:[Object(j.jsx)(x.a,{variant:"h6",gutterBottom:!0,noWrap:!0,children:a.title}),Object(j.jsx)(x.a,{variant:"body2",color:"textSecondary",style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:a.description}),Object(j.jsxs)(x.a,{className:e.price,children:["\xa5 ",a.price.toLocaleString()]})]}),Object(j.jsx)(de.a,{className:e.cardActions,children:Object(j.jsx)(S.a,{variant:"contained",color:"primary",className:e.buyButton,onClick:()=>{return e=a._id,void t.push("/items/".concat(e));var e},fullWidth:!0,children:"\u53bb\u8d2d\u4e70"})})]})},a._id)))})]})]})},xe=a(17),fe=a(198);const Oe=Object(b.a)((e=>({paper:{marginTop:e.spacing(8),padding:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},error:{color:e.palette.error.main,marginTop:e.spacing(2)}})));var ve=function(){const e=Oe(),t=Object(s.f)(),{login:a,message:c,setMessage:r}=g(),[i,o]=Object(n.useState)({email:"",password:""}),[l,d]=Object(n.useState)("");Object(n.useEffect)((()=>{if(c){const e=setTimeout((()=>{r("")}),3e3);return()=>clearTimeout(e)}}),[c,r]);const m=e=>{o(Object(xe.a)(Object(xe.a)({},i),{},{[e.target.name]:e.target.value}))};return Object(j.jsx)(u.a,{component:"main",maxWidth:"xs",children:Object(j.jsxs)(y.a,{className:e.paper,children:[Object(j.jsx)(x.a,{component:"h1",variant:"h5",children:"\u767b\u5f55"}),l&&Object(j.jsx)(x.a,{className:e.error,children:l}),c&&Object(j.jsx)(x.a,{className:e.success,children:c}),Object(j.jsxs)("form",{className:e.form,onSubmit:async e=>{e.preventDefault();try{const e=await fetch("http://localhost:5000/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),n=await e.json();if(!e.ok)throw new Error(n.message||"\u767b\u5f55\u5931\u8d25");a(n.user,n.token),t.push("/")}catch(n){d(n.message)}},children:[Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u90ae\u7bb1",name:"email",type:"email",value:i.email,onChange:m,autoFocus:!0}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u5bc6\u7801",name:"password",type:"password",value:i.password,onChange:m}),Object(j.jsx)(S.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"\u767b\u5f55"})]})]})})};const ye=Object(b.a)((e=>({paper:{marginTop:e.spacing(8),padding:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},error:{color:e.palette.error.main,marginTop:e.spacing(2)},success:{color:e.palette.success.main,marginTop:e.spacing(2)}})));var we=function(){const e=ye(),t=Object(s.f)(),[a,c]=Object(n.useState)({username:"",email:"",password:"",confirmPassword:""}),[r,i]=Object(n.useState)(""),[o,l]=Object(n.useState)(!1),d=e=>{c(Object(xe.a)(Object(xe.a)({},a),{},{[e.target.name]:e.target.value}))};return Object(j.jsx)(u.a,{component:"main",maxWidth:"xs",children:Object(j.jsxs)(y.a,{className:e.paper,children:[Object(j.jsx)(x.a,{component:"h1",variant:"h5",children:"\u6ce8\u518c"}),r&&Object(j.jsx)(x.a,{className:e.error,children:r}),o&&Object(j.jsx)(x.a,{className:e.success,children:"\u6ce8\u518c\u6210\u529f\uff01\u6b63\u5728\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762..."}),Object(j.jsxs)("form",{className:e.form,onSubmit:async e=>{if(e.preventDefault(),a.password===a.confirmPassword)try{const e=await fetch("http://localhost:5000/api/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a.username,email:a.email,password:a.password})}),n=await e.json();if(!e.ok)throw new Error(n.message||"\u6ce8\u518c\u5931\u8d25");l(!0),i(""),setTimeout((()=>{t.push("/login")}),2e3)}catch(n){i(n.message),l(!1)}else i("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u5339\u914d")},children:[Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u7528\u6237\u540d",name:"username",value:a.username,onChange:d}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u90ae\u7bb1",name:"email",type:"email",value:a.email,onChange:d}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u5bc6\u7801",name:"password",type:"password",value:a.password,onChange:d}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u786e\u8ba4\u5bc6\u7801",name:"confirmPassword",type:"password",value:a.confirmPassword,onChange:d}),Object(j.jsx)(S.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"\u6ce8\u518c"})]})]})})},Se=a(199);const Ce=Object(b.a)((e=>({paper:{marginTop:e.spacing(8),padding:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},formControl:{width:"100%",marginTop:e.spacing(2)},imagePreview:{width:"100%",maxHeight:300,objectFit:"contain",marginTop:e.spacing(2)}}))),Ne=["\u7535\u5b50\u4ea7\u54c1","\u670d\u88c5","\u56fe\u4e66","\u5bb6\u5c45","\u8fd0\u52a8","\u5176\u4ed6"];var ke=function(){const e=Ce(),t=Object(s.f)(),{user:a}=g(),[c,r]=Object(n.useState)({title:"",description:"",price:"",category:""}),[i,o]=Object(n.useState)(null),[l,d]=Object(n.useState)(""),[m,p]=Object(n.useState)(""),h=e=>{r(Object(xe.a)(Object(xe.a)({},c),{},{[e.target.name]:e.target.value}))};return Object(j.jsx)(u.a,{component:"main",maxWidth:"sm",children:Object(j.jsxs)(y.a,{className:e.paper,children:[Object(j.jsx)(x.a,{component:"h1",variant:"h5",children:"\u53d1\u5e03\u5546\u54c1"}),m&&Object(j.jsx)(x.a,{color:"error",gutterBottom:!0,children:m}),Object(j.jsxs)("form",{className:e.form,onSubmit:async e=>{if(e.preventDefault(),!a)return void p("\u8bf7\u5148\u767b\u5f55");const n=new FormData;n.append("title",c.title),n.append("description",c.description),n.append("price",c.price),n.append("category",c.category),n.append("userId",a.id),n.append("image",i);try{const e=await fetch("http://localhost:5000/api/items",{method:"POST",body:n}),a=await e.json();if(!e.ok)throw new Error(a.message||"\u53d1\u5e03\u5931\u8d25");t.push("/")}catch(r){p(r.message)}},children:[Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u5546\u54c1\u540d\u79f0",name:"title",value:c.title,onChange:h}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,multiline:!0,rows:4,label:"\u5546\u54c1\u63cf\u8ff0",name:"description",value:c.description,onChange:h}),Object(j.jsx)(fe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u4ef7\u683c",name:"price",type:"number",value:c.price,onChange:h}),Object(j.jsxs)(re.a,{variant:"outlined",className:e.formControl,children:[Object(j.jsx)(Se.a,{children:"\u5546\u54c1\u5206\u7c7b"}),Object(j.jsx)(ie.a,{value:c.category,onChange:h,label:"\u5546\u54c1\u5206\u7c7b",name:"category",required:!0,children:Ne.map((e=>Object(j.jsx)(V.a,{value:e,children:e},e)))})]}),Object(j.jsx)("input",{accept:"image/*",style:{display:"none"},id:"image-upload",type:"file",onChange:e=>{const t=e.target.files[0];t&&(o(t),d(URL.createObjectURL(t)))}}),Object(j.jsx)("label",{htmlFor:"image-upload",children:Object(j.jsx)(S.a,{variant:"contained",component:"span",fullWidth:!0,className:e.submit,children:"\u4e0a\u4f20\u56fe\u7247"})}),l&&Object(j.jsx)("img",{src:l,alt:"\u9884\u89c8",className:e.imagePreview}),Object(j.jsx)(S.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"\u53d1\u5e03\u5546\u54c1"})]})]})})},Ie=a(63),Be=a.n(Ie);const Te=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(3)},image:{width:"100%",height:"auto",maxHeight:"500px",objectFit:"contain"},price:{color:e.palette.primary.main,fontWeight:600,fontSize:"2rem",marginTop:e.spacing(2)},description:{marginTop:e.spacing(2),marginBottom:e.spacing(2),whiteSpace:"pre-wrap"},seller:{marginTop:e.spacing(2),color:e.palette.text.secondary},buttonGroup:{marginTop:e.spacing(3),"& > *":{margin:e.spacing(1)}},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"}})));var ze=function(){var e;const t=Te(),{id:a}=Object(s.g)(),c=Object(s.f)(),{user:r}=g(),[i,o]=Object(n.useState)(null),[l,d]=Object(n.useState)(!0),[m,p]=Object(n.useState)(!1),[h,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)({title:"",description:"",price:""});Object(n.useEffect)((()=>{w(),r&&C()}),[a,r]),Object(n.useEffect)((()=>{i&&v({title:i.title,description:i.description||"",price:i.price})}),[i]);const w=async()=>{try{const e=await fetch("http://localhost:5000/api/items/".concat(a));if(!e.ok)throw new Error("\u5546\u54c1\u4e0d\u5b58\u5728");const t=await e.json();o(t)}catch(e){console.error("Error fetching item:",e)}finally{d(!1)}},C=async()=>{try{const e=await fetch("http://localhost:5000/api/favorites/check/".concat(a),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();p(t.isFavorite)}catch(e){console.error("Error checking favorite status:",e)}};return l?Object(j.jsx)(u.a,{className:t.loadingContainer,children:Object(j.jsx)(I.a,{})}):i?Object(j.jsxs)(u.a,{className:t.container,children:[Object(j.jsx)(y.a,{className:t.paper,children:Object(j.jsxs)(O.a,{container:!0,spacing:4,children:[Object(j.jsx)(O.a,{item:!0,xs:12,md:6,children:Object(j.jsx)("img",{src:"http://localhost:5000".concat(i.image),alt:i.title,className:t.image})}),Object(j.jsxs)(O.a,{item:!0,xs:12,md:6,children:[Object(j.jsx)(x.a,{variant:"h4",component:"h1",children:i.title}),Object(j.jsxs)(x.a,{className:t.price,children:["\xa5 ",null===(e=i.price)||void 0===e?void 0:e.toLocaleString()]}),Object(j.jsx)(x.a,{className:t.description,variant:"body1",children:i.description}),Object(j.jsxs)(x.a,{className:t.seller,children:["\u5356\u5bb6\uff1a",i.seller.username]}),Object(j.jsx)("div",{className:t.buttonGroup,children:r&&r.id===i.seller._id?Object(j.jsx)(S.a,{variant:"contained",color:"primary",startIcon:Object(j.jsx)(_.a,{}),onClick:()=>b(!0),children:"\u7f16\u8f91\u5546\u54c1"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(S.a,{variant:"contained",color:"primary",onClick:async()=>{try{console.log("\u6b63\u5728\u521b\u5efa\u8ba2\u5355 - \u5546\u54c1ID:",i._id);const e=await fetch("http://localhost:5000/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({itemId:i._id})});if(!e.ok){const t=await e.json();throw new Error(t.message||"\u8d2d\u4e70\u5931\u8d25")}const t=await e.json();console.log("\u8ba2\u5355\u521b\u5efa\u6210\u529f:",t),alert("\u8d2d\u4e70\u6210\u529f\uff01"),c.push("/my-items")}catch(e){console.error("\u8d2d\u4e70\u5931\u8d25:",e),alert("\u8d2d\u4e70\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}},disabled:!r||r.id===i.seller._id,style:{backgroundColor:"#ff4081"},children:"\u7acb\u5373\u8d2d\u4e70"}),Object(j.jsx)(S.a,{variant:"contained",color:"primary",startIcon:Object(j.jsx)(Z.a,{}),onClick:async()=>{try{const e=await fetch("http://localhost:5000/api/cart/add",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({itemId:i._id})}),t=await e.json();if(!e.ok)throw new Error(t.message||"\u6dfb\u52a0\u5931\u8d25");alert("\u6210\u529f\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66\uff01")}catch(e){console.error("Error adding to cart:",e),alert(e.message||"\u6dfb\u52a0\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}},children:"\u52a0\u5165\u8d2d\u7269\u8f66"}),Object(j.jsx)(S.a,{variant:"outlined",color:"primary",onClick:()=>{r?c.push("/messages",{selectedUser:i.seller}):alert("\u8bf7\u5148\u767b\u5f55")},disabled:!r||r.id===i.seller._id,children:"\u8054\u7cfb\u5356\u5bb6"}),Object(j.jsx)(S.a,{variant:"outlined",color:"primary",startIcon:m?Object(j.jsx)(q.a,{}):Object(j.jsx)(Be.a,{}),onClick:async()=>{if(r)try{const e=m?"DELETE":"POST";(await fetch("http://localhost:5000/api/favorites/".concat(a),{method:e,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok&&p(!m)}catch(e){console.error("Error toggling favorite:",e)}else c.push("/login")},children:m?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf"})]})})]})]})}),Object(j.jsxs)(T.a,{open:h,onClose:()=>b(!1),maxWidth:"sm",fullWidth:!0,children:[Object(j.jsx)(z.a,{children:"\u7f16\u8f91\u5546\u54c1\u4fe1\u606f"}),Object(j.jsxs)(W.a,{children:[Object(j.jsx)(fe.a,{name:"title",label:"\u5546\u54c1\u540d\u79f0",value:f.title,onChange:e=>v(Object(xe.a)(Object(xe.a)({},f),{},{title:e.target.value})),fullWidth:!0,margin:"normal"}),Object(j.jsx)(fe.a,{name:"description",label:"\u5546\u54c1\u63cf\u8ff0",value:f.description,onChange:e=>v(Object(xe.a)(Object(xe.a)({},f),{},{description:e.target.value})),fullWidth:!0,multiline:!0,rows:4,margin:"normal"}),Object(j.jsx)(fe.a,{name:"price",label:"\u4ef7\u683c",value:f.price,onChange:e=>v(Object(xe.a)(Object(xe.a)({},f),{},{price:e.target.value})),fullWidth:!0,type:"number",margin:"normal"})]}),Object(j.jsxs)(E.a,{children:[Object(j.jsx)(S.a,{onClick:()=>b(!1),children:"\u53d6\u6d88"}),Object(j.jsx)(S.a,{onClick:async()=>{try{const e=await fetch("http://localhost:5000/api/items/".concat(i._id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(f)});if(!e.ok)throw new Error("\u66f4\u65b0\u5931\u8d25");const t=await e.json();o(t),b(!1)}catch(e){console.error("Error updating item:",e),alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}},color:"primary",variant:"contained",children:"\u4fdd\u5b58"})]})]})]}):Object(j.jsx)(u.a,{children:Object(j.jsx)(x.a,{variant:"h5",children:"\u5546\u54c1\u4e0d\u5b58\u5728"})})};const We=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},card:{height:"100%",display:"flex",flexDirection:"column"},cardMedia:{paddingTop:"56.25%",position:"relative"},cardContent:{flexGrow:1},price:{color:e.palette.primary.main,fontWeight:600,fontSize:"1.25rem",marginTop:e.spacing(1)},deleteButton:{marginLeft:"auto"},noFavorites:{textAlign:"center",padding:e.spacing(4)}})));var Ee=function(){const e=We(),t=Object(s.f)(),{user:a}=g(),[c,r]=Object(n.useState)([]),[i,o]=Object(n.useState)(!0),[l,d]=Object(n.useState)("");Object(n.useEffect)((()=>{m()}),[]);const m=async()=>{try{const e=await fetch("http://localhost:5000/api/favorites",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();r(t)}catch(e){console.error("Error fetching favorites:",e),d("\u83b7\u53d6\u6536\u85cf\u5931\u8d25")}finally{o(!1)}};return i?Object(j.jsx)(u.a,{className:e.container,children:Object(j.jsx)(x.a,{children:"\u52a0\u8f7d\u4e2d..."})}):a?0===c.length?Object(j.jsx)(u.a,{className:e.container,children:Object(j.jsxs)(y.a,{className:e.noFavorites,children:[Object(j.jsx)(x.a,{variant:"h6",children:"\u6682\u65e0\u6536\u85cf\u5546\u54c1"}),Object(j.jsx)(S.a,{color:"primary",onClick:()=>t.push("/"),style:{marginTop:16},children:"\u53bb\u901b\u901b"})]})}):Object(j.jsxs)(u.a,{className:e.container,children:[Object(j.jsx)(x.a,{variant:"h4",gutterBottom:!0,children:"\u6211\u7684\u6536\u85cf"}),Object(j.jsx)(O.a,{container:!0,spacing:4,children:c.map((a=>{var n;return Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,md:4,children:Object(j.jsxs)(oe.a,{className:e.card,children:[Object(j.jsx)(se.a,{className:e.cardMedia,image:"http://localhost:5000".concat(a.image),title:a.title,onClick:()=>{return e=a._id,void t.push("/items/".concat(e));var e},style:{cursor:"pointer"}}),Object(j.jsxs)(le.a,{className:e.cardContent,children:[Object(j.jsx)(x.a,{gutterBottom:!0,variant:"h6",component:"h2",children:a.title}),Object(j.jsxs)(x.a,{className:e.price,children:["\xa5 ",null===(n=a.price)||void 0===n?void 0:n.toLocaleString()]})]}),Object(j.jsx)(de.a,{children:Object(j.jsx)(B.a,{className:e.deleteButton,onClick:()=>(async e=>{try{(await fetch("http://localhost:5000/api/favorites/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok&&(r(c.filter((t=>t._id!==e))),d("\u5df2\u53d6\u6d88\u6536\u85cf"))}catch(t){console.error("Error removing favorite:",t),d("\u53d6\u6d88\u6536\u85cf\u5931\u8d25")}})(a._id),children:Object(j.jsx)(P.a,{})})})]})},a._id)}))})]}):Object(j.jsx)(u.a,{className:e.container,children:Object(j.jsx)(y.a,{className:e.noFavorites,children:Object(j.jsx)(x.a,{variant:"h6",children:"\u8bf7\u5148\u767b\u5f55"})})})},Ae=a(193);const De=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},card:{display:"flex",marginBottom:e.spacing(2)},cardMedia:{width:150},cardContent:{flex:1},totalSection:{marginTop:e.spacing(3),padding:e.spacing(2)},deleteButton:{marginLeft:"auto"},checkoutButton:{marginTop:e.spacing(2),padding:e.spacing(1.5),borderRadius:25},dialogContent:{padding:e.spacing(3)},dialogPrice:{color:e.palette.primary.main,fontWeight:600,fontSize:"1.5rem",marginTop:e.spacing(2)}})));var Le=function(){var e;const t=De(),{user:a}=g(),c=Object(s.f)(),[r,i]=Object(n.useState)([]),[o,l]=Object(n.useState)(!0),[d,m]=Object(n.useState)(""),[p,h]=Object(n.useState)(!1);Object(n.useEffect)((()=>{b()}),[]);const b=async()=>{try{const e=await fetch("http://localhost:5000/api/cart",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();i(t)}catch(e){console.error("Error fetching cart items:",e)}finally{l(!1)}},f=()=>r.reduce(((e,t)=>e+t.price),0);return Object(j.jsxs)(u.a,{className:t.container,children:[Object(j.jsx)(x.a,{variant:"h4",gutterBottom:!0,children:"\u8d2d\u7269\u8f66"}),o?Object(j.jsx)(x.a,{children:"\u52a0\u8f7d\u4e2d..."}):0===r.length?Object(j.jsx)(x.a,{children:"\u8d2d\u7269\u8f66\u662f\u7a7a\u7684"}):Object(j.jsxs)(j.Fragment,{children:[r.map((e=>Object(j.jsxs)(oe.a,{className:t.card,children:[Object(j.jsx)(se.a,{className:t.cardMedia,image:"http://localhost:5000".concat(e.image),title:e.title}),Object(j.jsxs)(le.a,{className:t.cardContent,children:[Object(j.jsx)(x.a,{variant:"h6",children:e.title}),Object(j.jsxs)(x.a,{variant:"h6",color:"primary",children:["\xa5",e.price]})]}),Object(j.jsx)(B.a,{className:t.deleteButton,onClick:()=>(async e=>{try{(await fetch("http://localhost:5000/api/cart/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok&&i(r.filter((t=>t._id!==e)))}catch(t){console.error("Error removing item from cart:",t)}})(e._id),children:Object(j.jsx)(P.a,{})})]},e._id))),Object(j.jsxs)(y.a,{className:t.totalSection,children:[Object(j.jsxs)(x.a,{variant:"h6",children:["\u603b\u8ba1: \xa5",f()]}),Object(j.jsx)(S.a,{variant:"contained",color:"primary",fullWidth:!0,className:t.checkoutButton,onClick:()=>h(!0),disabled:(null===a||void 0===a?void 0:a.balance)<f(),children:(null===a||void 0===a?void 0:a.balance)<f()?"\u4f59\u989d\u4e0d\u8db3":"\u7ed3\u7b97"})]}),Object(j.jsxs)(T.a,{open:p,onClose:()=>h(!1),maxWidth:"sm",fullWidth:!0,children:[Object(j.jsx)(z.a,{children:"\u786e\u8ba4\u8d2d\u4e70"}),Object(j.jsxs)(W.a,{className:t.dialogContent,children:[Object(j.jsxs)(x.a,{variant:"h6",gutterBottom:!0,children:["\u8d2d\u7269\u8f66\u5546\u54c1 (",r.length,")"]}),Object(j.jsxs)(x.a,{className:t.dialogPrice,children:["\u603b\u8ba1: \xa5",f()]}),Object(j.jsxs)(x.a,{color:"textSecondary",children:["\u8d2d\u4e70\u540e\u4f59\u989d: \xa5",null===(e=(null===a||void 0===a?void 0:a.balance)-f())||void 0===e?void 0:e.toLocaleString()]})]}),Object(j.jsxs)(E.a,{children:[Object(j.jsx)(S.a,{onClick:()=>h(!1),color:"primary",children:"\u53d6\u6d88"}),Object(j.jsx)(S.a,{onClick:async()=>{try{const e=await fetch("http://localhost:5000/api/transactions/purchase-cart",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();e.ok?(m("\u8d2d\u4e70\u6210\u529f\uff01\u611f\u8c22\u60a8\u7684\u8d2d\u4e70\uff0c\u795d\u60a8\u8d2d\u7269\u6109\u5feb\uff01"),h(!1),setTimeout((()=>{c.push("/profile")}),2e3)):m(t.message||"\u8d2d\u4e70\u5931\u8d25")}catch(e){console.error("Checkout error:",e),m("\u8d2d\u4e70\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}},color:"primary",variant:"contained",children:"\u786e\u8ba4\u8d2d\u4e70"})]})]}),Object(j.jsx)(Ae.a,{open:!!d,autoHideDuration:2e3,onClose:()=>m(""),message:d,anchorOrigin:{vertical:"top",horizontal:"center"}})]})]})},Pe=a(72),Re=a.n(Pe),_e=a(90),Fe=a.n(_e);const Me=e=>{const t=Math.floor((new Date-new Date(e))/1e3);let a=t/31536e3;return a>1?Math.floor(a)+" \u5e74\u524d":(a=t/2592e3,a>1?Math.floor(a)+" \u4e2a\u6708\u524d":(a=t/86400,a>1?Math.floor(a)+" \u5929\u524d":(a=t/3600,a>1?Math.floor(a)+" \u5c0f\u65f6\u524d":(a=t/60,a>1?Math.floor(a)+" \u5206\u949f\u524d":"\u521a\u521a"))))},He=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},sectionTitle:{fontWeight:600,marginBottom:e.spacing(3),display:"flex",alignItems:"center",gap:e.spacing(1),"& svg":{color:e.palette.primary.main}},card:{height:"100%",display:"flex",flexDirection:"column",cursor:"pointer",transition:"all 0.3s ease",borderRadius:e.spacing(1.5),boxShadow:"0 2px 8px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-8px)",boxShadow:"0 12px 20px rgba(0,0,0,0.12)"}},cardMedia:{height:220,backgroundSize:"cover",borderRadius:"".concat(e.spacing(1.5),"px ").concat(e.spacing(1.5),"px 0 0")},cardContent:{flexGrow:1,padding:e.spacing(2)},price:{color:e.palette.error.main,fontWeight:700,fontSize:"1.25rem",display:"flex",alignItems:"center",gap:e.spacing(.5),marginTop:e.spacing(1)},priceIcon:{fontSize:"1rem",color:e.palette.error.light},sellerInfo:{display:"flex",alignItems:"center",padding:e.spacing(2),backgroundColor:e.palette.background.default,borderRadius:"".concat(e.spacing(1.5),"px ").concat(e.spacing(1.5),"px 0 0")},avatar:{width:32,height:32,marginRight:e.spacing(1),border:"2px solid ".concat(e.palette.background.paper)},username:{fontSize:"0.9rem",fontWeight:500,color:e.palette.text.primary},timeChip:{marginLeft:"auto",backgroundColor:e.palette.background.paper,fontSize:"0.75rem"},title:{fontSize:"1rem",fontWeight:500,marginBottom:e.spacing(1),display:"-webkit-box","-webkit-line-clamp":2,"-webkit-box-orient":"vertical",overflow:"hidden",textOverflow:"ellipsis"},description:{color:e.palette.text.secondary,fontSize:"0.875rem",marginBottom:e.spacing(1),display:"-webkit-box","-webkit-line-clamp":2,"-webkit-box-orient":"vertical",overflow:"hidden"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},divider:{margin:e.spacing(6,0)},emptyMessage:{textAlign:"center",padding:e.spacing(4),backgroundColor:e.palette.background.paper,borderRadius:e.spacing(2)}})));var qe=function(){const e=He(),t=Object(s.f)(),[a,c]=Object(n.useState)([]),[r,i]=Object(n.useState)(!0);Object(n.useEffect)((()=>{o();const e=setInterval(o,6e4);return()=>clearInterval(e)}),[]);const o=async()=>{try{i(!0);const e=await fetch("http://localhost:5000/api/items",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json(),a=new Date(Date.now()-36e5),n=t.filter((e=>new Date(e.createdAt)>a)).sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)));c(n)}catch(e){console.error("Error:",e),c([])}finally{i(!1)}};return r?Object(j.jsx)(u.a,{className:e.loadingContainer,children:Object(j.jsx)(I.a,{})}):Object(j.jsxs)(u.a,{className:e.container,children:[Object(j.jsxs)(f.a,{mb:4,children:[Object(j.jsxs)(x.a,{variant:"h5",className:e.sectionTitle,children:[Object(j.jsx)(Fe.a,{}),"\u6700\u65b0\u4e0a\u67b6",Object(j.jsx)(ce.a,{size:"small",label:"1\u5c0f\u65f6\u5185",color:"primary",style:{marginLeft:8}})]}),a.length>0?Object(j.jsx)(O.a,{container:!0,spacing:3,children:a.map((a=>Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(j.jsxs)(oe.a,{className:e.card,onClick:()=>{return e=a._id,void t.push("/items/".concat(e));var e},children:[Object(j.jsxs)(f.a,{className:e.sellerInfo,children:[Object(j.jsx)(w.a,{src:a.seller&&a.seller.avatar,className:e.avatar,children:a.seller&&a.seller.username&&a.seller.username[0]}),Object(j.jsx)(x.a,{className:e.username,children:a.seller&&a.seller.username}),Object(j.jsx)(ce.a,{size:"small",className:e.timeChip,label:Me(a.createdAt)})]}),Object(j.jsx)(se.a,{className:e.cardMedia,image:a.image?"http://localhost:5000".concat(a.image):"/default-item-image.jpg",title:a.title}),Object(j.jsxs)(le.a,{className:e.cardContent,children:[Object(j.jsx)(x.a,{className:e.title,children:a.title}),a.description&&Object(j.jsx)(x.a,{className:e.description,children:a.description}),Object(j.jsxs)(x.a,{className:e.price,children:[Object(j.jsx)(Re.a,{className:e.priceIcon}),"\xa5 ",a.price&&a.price.toLocaleString()]})]})]})},a._id)))}):Object(j.jsxs)(f.a,{className:e.emptyMessage,children:[Object(j.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"\u6682\u65e0\u6700\u65b0\u5546\u54c1"}),Object(j.jsx)(x.a,{color:"textSecondary",children:"\u7a0d\u540e\u518d\u6765\u770b\u770b\u5427\uff01"})]})]}),Object(j.jsx)(k.a,{className:e.divider})]})};const Je=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(3)},title:{marginBottom:e.spacing(3),fontWeight:500},form:{marginTop:e.spacing(2)},submitButton:{marginTop:e.spacing(2)},message:{marginTop:e.spacing(2)}})));var Ue=function(){const e=Je(),{user:t,updateUser:a}=g(),[c,r]=(Object(s.f)(),Object(n.useState)({username:(null===t||void 0===t?void 0:t.username)||"",email:(null===t||void 0===t?void 0:t.email)||"",currentPassword:"",newPassword:"",confirmPassword:""})),[i,o]=Object(n.useState)(""),[l,d]=Object(n.useState)(!1),m=e=>{r(Object(xe.a)(Object(xe.a)({},c),{},{[e.target.name]:e.target.value}))};return Object(j.jsx)(u.a,{className:e.container,children:Object(j.jsxs)(y.a,{className:e.paper,children:[Object(j.jsx)(x.a,{variant:"h5",className:e.title,children:"\u8d26\u6237\u8bbe\u7f6e"}),Object(j.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d(!0),o(""),c.newPassword&&c.newPassword!==c.confirmPassword)return o("\u65b0\u5bc6\u7801\u4e0e\u786e\u8ba4\u5bc6\u7801\u4e0d\u5339\u914d"),void d(!1);try{const e=await fetch("http://localhost:5000/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({username:c.username,email:c.email,currentPassword:c.currentPassword||void 0,newPassword:c.newPassword||void 0})}),t=await e.json();if(!e.ok)throw new Error(t.message||"\u66f4\u65b0\u5931\u8d25");a(t),o("\u8d26\u6237\u4fe1\u606f\u66f4\u65b0\u6210\u529f\uff01"),r((e=>Object(xe.a)(Object(xe.a)({},e),{},{currentPassword:"",newPassword:"",confirmPassword:""}))),alert("\u4fdd\u5b58\u6210\u529f\uff01")}catch(t){o(t.message),alert(t.message||"\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}finally{d(!1)}},className:e.form,children:[Object(j.jsxs)(O.a,{container:!0,spacing:3,children:[Object(j.jsx)(O.a,{item:!0,xs:12,children:Object(j.jsx)(fe.a,{name:"username",label:"\u7528\u6237\u540d",value:c.username,onChange:m,fullWidth:!0,required:!0})}),Object(j.jsx)(O.a,{item:!0,xs:12,children:Object(j.jsx)(fe.a,{name:"email",label:"\u90ae\u7bb1",type:"email",value:c.email,onChange:m,fullWidth:!0,required:!0})}),Object(j.jsx)(O.a,{item:!0,xs:12,children:Object(j.jsx)(x.a,{variant:"subtitle1",gutterBottom:!0,children:"\u4fee\u6539\u5bc6\u7801\uff08\u5982\u4e0d\u4fee\u6539\u8bf7\u7559\u7a7a\uff09"})}),Object(j.jsx)(O.a,{item:!0,xs:12,children:Object(j.jsx)(fe.a,{name:"currentPassword",label:"\u5f53\u524d\u5bc6\u7801",type:"password",value:c.currentPassword,onChange:m,fullWidth:!0})}),Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(j.jsx)(fe.a,{name:"newPassword",label:"\u65b0\u5bc6\u7801",type:"password",value:c.newPassword,onChange:m,fullWidth:!0})}),Object(j.jsx)(O.a,{item:!0,xs:12,sm:6,children:Object(j.jsx)(fe.a,{name:"confirmPassword",label:"\u786e\u8ba4\u65b0\u5bc6\u7801",type:"password",value:c.confirmPassword,onChange:m,fullWidth:!0})})]}),i&&Object(j.jsx)(f.a,{className:e.message,children:Object(j.jsx)(x.a,{color:i.includes("\u6210\u529f")?"primary":"error",children:i})}),Object(j.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",className:e.submitButton,disabled:l,children:l?"\u4fdd\u5b58\u4e2d...":"\u4fdd\u5b58\u4fee\u6539"})]})]})})},Ge=a(91),Ye=a.n(Ge);const Ke=Object(b.a)((e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},pageTitle:{fontWeight:600,marginBottom:e.spacing(4),display:"flex",alignItems:"center",gap:e.spacing(1),"& svg":{color:e.palette.primary.main}},card:{display:"flex",marginBottom:e.spacing(2),borderRadius:e.spacing(2),boxShadow:"0 2px 8px rgba(0,0,0,0.08)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 16px rgba(0,0,0,0.12)"}},cardMedia:{width:160,height:160,objectFit:"cover",borderRadius:e.spacing(1),margin:e.spacing(2)},cardContent:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:e.spacing(2)},orderInfo:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:e.spacing(2)},price:{color:e.palette.error.main,fontWeight:700,fontSize:"1.25rem",display:"flex",alignItems:"center",gap:e.spacing(.5)},priceIcon:{fontSize:"1rem",color:e.palette.error.light},status:{marginLeft:"auto"},orderTime:{display:"flex",alignItems:"center",gap:e.spacing(.5),color:e.palette.text.secondary,fontSize:"0.875rem",marginTop:e.spacing(1)},title:{fontWeight:500,marginBottom:e.spacing(1)},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},emptyContainer:{textAlign:"center",padding:e.spacing(4),backgroundColor:e.palette.background.paper,borderRadius:e.spacing(2),marginTop:e.spacing(4)},actionButton:{marginTop:e.spacing(2)}})));var Qe=function(){const e=Ke(),t=Object(s.f)(),[a,c]=Object(n.useState)([]),[r,i]=Object(n.useState)(!0);Object(n.useEffect)((()=>{o()}),[]);const o=async()=>{try{i(!0);const e=localStorage.getItem("token");console.log("\u5f53\u524dtoken:",e);const t=await fetch("http://localhost:5000/api/orders",{headers:{Authorization:"Bearer ".concat(e)}});if(console.log("\u54cd\u5e94\u72b6\u6001:",t.status),!t.ok)throw new Error("\u83b7\u53d6\u8ba2\u5355\u5931\u8d25");const a=await t.json();console.log("\u83b7\u53d6\u5230\u7684\u8ba2\u5355\u6570\u636e:",a),c(a)}catch(e){console.error("\u83b7\u53d6\u8ba2\u5355\u5931\u8d25:",e),c([])}finally{i(!1)}};return r?Object(j.jsx)(u.a,{className:e.loadingContainer,children:Object(j.jsx)(I.a,{})}):Object(j.jsxs)(u.a,{className:e.container,children:[Object(j.jsxs)(x.a,{variant:"h5",className:e.pageTitle,children:[Object(j.jsx)(Ye.a,{}),"\u6211\u7684\u8ba2\u5355"]}),r?Object(j.jsx)(f.a,{className:e.loadingContainer,children:Object(j.jsx)(I.a,{})}):a.length>0?a.map((a=>{var n;return Object(j.jsx)(oe.a,{className:e.card,children:a.item?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(se.a,{className:e.cardMedia,image:a.item.image?"http://localhost:5000".concat(a.item.image):"/default-item-image.jpg",title:a.item.title,onClick:()=>{return e=a.item._id,void t.push("/items/".concat(e));var e}}),Object(j.jsxs)(le.a,{className:e.cardContent,children:[Object(j.jsxs)(f.a,{className:e.orderInfo,children:[Object(j.jsx)(x.a,{variant:"h6",className:e.title,children:a.item.title}),Object(j.jsx)(ce.a,{label:"\u5df2\u4ed8\u6b3e",color:"primary",size:"small",className:e.statusChip})]}),Object(j.jsx)(x.a,{variant:"body2",color:"textSecondary",children:a.item.description}),Object(j.jsxs)(x.a,{className:e.price,children:[Object(j.jsx)(Re.a,{className:e.priceIcon}),"\xa5 ",null===(n=a.item.price)||void 0===n?void 0:n.toLocaleString()]}),Object(j.jsxs)(x.a,{variant:"caption",color:"textSecondary",children:["\u4e0b\u5355\u65f6\u95f4: ",new Date(a.createdAt).toLocaleString()]})]})]}):Object(j.jsxs)(le.a,{className:e.cardContent,children:[Object(j.jsxs)(f.a,{className:e.orderInfo,children:[Object(j.jsx)(x.a,{variant:"h6",className:e.title,style:{color:"#999"},children:"\u5546\u54c1\u5df2\u4e0b\u67b6"}),Object(j.jsx)(ce.a,{label:"\u5df2\u4ed8\u6b3e",color:"primary",size:"small",className:e.statusChip})]}),Object(j.jsxs)(x.a,{variant:"caption",color:"textSecondary",children:["\u4e0b\u5355\u65f6\u95f4: ",new Date(a.createdAt).toLocaleString()]})]})},a._id)})):Object(j.jsxs)(f.a,{className:e.emptyContainer,children:[Object(j.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"\u6682\u65e0\u8ba2\u5355"}),Object(j.jsx)(x.a,{color:"textSecondary",gutterBottom:!0,children:"\u53bb\u53d1\u73b0\u66f4\u591a\u597d\u7269\u5427\uff01"}),Object(j.jsx)(S.a,{variant:"contained",color:"primary",className:e.actionButton,onClick:()=>t.push("/"),children:"\u6d4f\u89c8\u5546\u54c1"})]})]})},Ve=a(176),Xe=a(127),Ze=a(185),$e=a(186);const et=Object(b.a)((e=>({container:{marginTop:e.spacing(4),display:"flex",gap:e.spacing(2)},userList:{width:"30%",minWidth:250},chatBox:{flex:1,display:"flex",flexDirection:"column"},messageList:{flex:1,minHeight:400,maxHeight:600,overflowY:"auto",padding:e.spacing(2),backgroundColor:"#f5f5f5"},messageInput:{padding:e.spacing(2)},myMessage:{backgroundColor:"#FF7B7B",color:"white",padding:"8px 12px",borderRadius:"4px",display:"inline-block",marginLeft:"auto",marginBottom:"2px",fontSize:"14px",whiteSpace:"pre-wrap"},otherMessage:{backgroundColor:"white",color:"black",padding:"8px 12px",borderRadius:"4px",display:"inline-block",marginRight:"auto",marginBottom:"2px",fontSize:"14px",whiteSpace:"pre-wrap"},messageTime:{fontSize:"12px",color:"#999",marginTop:"4px"}})));var tt=function(){const e=et(),{user:t}=g(),a=Object(n.useRef)(null),[c,r]=Object(n.useState)([]),[i,o]=Object(n.useState)(null),[s,l]=Object(n.useState)([]),[d,m]=Object(n.useState)(""),[p,h]=Object(n.useState)({});Object(n.useEffect)((()=>{(async()=>{try{const e=await fetch("http://localhost:5000/api/users",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),a=await e.json();r(a.filter((e=>e._id!==t.id)))}catch(e){console.error("Error:",e)}})()}),[t.id]),Object(n.useEffect)((()=>{if(i){(async()=>{try{const e=await fetch("http://localhost:5000/api/messages/".concat(i._id),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t=await e.json();l(t),await fetch("http://localhost:5000/api/messages/read/".concat(i._id),{method:"PUT",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})}catch(e){console.error("Error:",e)}})()}}),[i]);const b=async()=>{if(d.trim()&&i)try{const e=await fetch("http://localhost:5000/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({receiverId:i._id,content:d.trim()})}),t=await e.json();e.ok?(l((e=>[...e,t])),m("")):alert(t.message||"\u53d1\u9001\u5931\u8d25")}catch(e){console.error("Error:",e),alert("\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}};return Object(j.jsxs)(u.a,{className:e.container,children:[Object(j.jsx)(y.a,{className:e.userList,children:Object(j.jsx)(Ve.a,{children:c.map((e=>Object(j.jsxs)(Xe.a,{button:!0,selected:(null===i||void 0===i?void 0:i._id)===e._id,onClick:()=>o(e),children:[Object(j.jsx)(Ze.a,{children:Object(j.jsx)(K.a,{badgeContent:p[e._id]>0?p[e._id]:null,color:"secondary",overlap:"circular",anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(j.jsx)(w.a,{children:e.username[0]})})}),Object(j.jsx)($e.a,{primary:Object(j.jsxs)(f.a,{display:"flex",alignItems:"center",children:[Object(j.jsx)(x.a,{children:e.username}),p[e._id]>0&&Object(j.jsx)(f.a,{ml:1,bgcolor:"secondary.main",color:"white",px:1,borderRadius:"10px",fontSize:"12px",children:p[e._id]})]})})]},e._id)))})}),Object(j.jsx)(y.a,{className:e.chatBox,children:i?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(f.a,{p:2,children:Object(j.jsxs)(x.a,{variant:"h6",children:["\u4e0e ",i.username," \u7684\u5bf9\u8bdd"]})}),Object(j.jsxs)(f.a,{className:e.messageList,children:[s.map((a=>{var n;const c=a.sender===t.id||(null===(n=a.sender)||void 0===n?void 0:n._id)===t.id;return Object(j.jsxs)(f.a,{style:{display:"flex",flexDirection:"column",alignItems:c?"flex-end":"flex-start"},children:[Object(j.jsx)(f.a,{className:c?e.myMessage:e.otherMessage,children:a.content}),Object(j.jsx)(x.a,{className:e.messageTime,style:{alignSelf:c?"flex-end":"flex-start"},children:new Date(a.createdAt).toLocaleString()})]},a._id)})),Object(j.jsx)("div",{ref:a})]}),Object(j.jsxs)(f.a,{className:e.messageInput,children:[Object(j.jsx)(fe.a,{fullWidth:!0,multiline:!0,rows:2,variant:"outlined",placeholder:"\u8f93\u5165\u6d88\u606f...",value:d,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())}}),Object(j.jsx)(f.a,{mt:1,display:"flex",justifyContent:"flex-end",children:Object(j.jsx)(S.a,{variant:"contained",color:"primary",onClick:b,disabled:!d.trim(),children:"\u53d1\u9001"})})]})]}):Object(j.jsx)(f.a,{p:4,textAlign:"center",children:Object(j.jsx)(x.a,{color:"textSecondary",children:"\u9009\u62e9\u4e00\u4e2a\u7528\u6237\u5f00\u59cb\u804a\u5929"})})})]})};const at=Object(l.a)({palette:{primary:{main:"#ff7875",light:"#ff7875",dark:"#cf1322"},secondary:{main:"#722ED1",light:"#9254DE",dark:"#531DAB"},background:{default:"#FAFAFA",paper:"#FFFFFF"},text:{primary:"#1A1A1A",secondary:"#666666"}},typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(","),h1:{fontWeight:600,letterSpacing:"-0.5px"},h2:{fontWeight:600,letterSpacing:"-0.5px"},h3:{fontWeight:600,letterSpacing:"-0.5px"},h4:{fontWeight:600},h5:{fontWeight:600},h6:{fontWeight:600},subtitle1:{fontSize:"1rem",fontWeight:500},subtitle2:{fontSize:"0.875rem",fontWeight:500},body1:{fontSize:"1rem",lineHeight:1.5},body2:{fontSize:"0.875rem",lineHeight:1.5},button:{textTransform:"none",fontWeight:500}},shape:{borderRadius:8},shadows:["none","0 1px 2px rgba(0,0,0,0.06)","0 1px 3px rgba(0,0,0,0.1)","0 2px 4px rgba(0,0,0,0.12)","0 3px 6px rgba(0,0,0,0.15)","0 4px 8px rgba(0,0,0,0.16)","0 6px 12px rgba(0,0,0,0.18)"],overrides:{MuiButton:{root:{borderRadius:25,padding:"6px 16px"},contained:{boxShadow:"none","&:hover":{boxShadow:"0 2px 6px rgba(0,0,0,0.12)"}}},MuiPaper:{rounded:{borderRadius:12},elevation1:{boxShadow:"0 1px 3px rgba(0,0,0,0.08)"}},MuiCard:{root:{borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"}}}});var nt=function(){return Object(j.jsxs)(d.a,{theme:at,children:[Object(j.jsx)(m.a,{}),Object(j.jsx)(h,{children:Object(j.jsxs)(o.a,{children:[Object(j.jsx)(ae,{}),Object(j.jsxs)(s.c,{children:[Object(j.jsx)(s.a,{exact:!0,path:"/",component:ue}),Object(j.jsx)(s.a,{path:"/login",component:ve}),Object(j.jsx)(s.a,{path:"/register",component:we}),Object(j.jsx)(s.a,{path:"/items/new",component:ke}),Object(j.jsx)(s.a,{path:"/profile",component:U}),Object(j.jsx)(s.a,{path:"/items/:id",component:ze}),Object(j.jsx)(s.a,{path:"/favorites",component:Ee}),Object(j.jsx)(s.a,{path:"/cart",component:Le}),Object(j.jsx)(s.a,{path:"/discover",component:qe}),Object(j.jsx)(s.a,{path:"/my-items",component:Qe}),Object(j.jsx)(s.a,{path:"/messages",component:tt}),Object(j.jsx)(s.a,{path:"/account/settings",component:Ue})]})]})})]})};var ct=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,201)).then((t=>{let{getCLS:a,getFID:n,getFCP:c,getLCP:r,getTTFB:i}=t;a(e),n(e),c(e),r(e),i(e)}))};i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(nt,{})}),document.getElementById("root")),ct()}},[[124,1,2]]]);
//# sourceMappingURL=main.d4b11bc3.chunk.js.map